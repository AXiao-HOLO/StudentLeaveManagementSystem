<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.student.mapper.StudentMapper">

    <resultMap id="BaseResultMap" type="com.student.domain.Student">
            <id property="id" column="id" />
            <result property="studentNo" column="student_no" />
            <result property="name" column="name" />
            <result property="classId" column="class_id" />
            <result property="gender" column="gender" />
            <result property="phone" column="phone" />
            <result property="email" column="email" />
            <result property="createTime" column="create_time" />
            <result property="updateTime" column="update_time" />
    </resultMap>


    <sql id="Base_Column_List">
        id,student_no,name,class_id,gender,phone,
        email,create_time,update_time
    </sql>
    <select id="list" resultType="com.student.domain.Student">
        -- 查询所有的学生信息，如果学生关联了班级，也要查询出班级信息
        select s.*, c.class_name as className from student as s left join clazz as c on s.class_id = c.id
        <where>
            <if test="studentNo != null and studentNo != ''">
                and s.student_no like concat('%',#{studentNo},'%')
            </if>
            <if test="name != null and name != ''">
                and s.name like concat('%',#{name},'%')
            </if>
            <if test="gender != null">
                and s.gender = #{gender}
            </if>
            <if test="phone != null and phone != ''">
                and s.phone like concat('%',#{phone},'%')
            </if>
            <if test="email != null and email != ''">
                and s.email like concat('%',#{email},'%')
            </if>
            <if test="className != null and className != ''">
                and c.class_name like concat('%',#{className},'%')
            </if>
        </where>
    </select>
</mapper>
